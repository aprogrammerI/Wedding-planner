<div class="wedding-details-container">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <h1 class="page-title">Wedding Overview</h1>
        <p class="page-subtitle">Complete overview of your special day</p>
      </div>
    </div>

    <!-- Couple Details Section -->
    <div class="section-card">
      <div class="section-header">
        <h2><i class="fas fa-heart"></i> Couple Details</h2>
        <button class="btn btn-primary btn-sm" (click)="saveCoupleDetails()">Save</button>
      </div>
      
      <!-- Input Form - shown initially -->
      <div *ngIf="!showCouplePhoto" class="couple-form">
        <div class="row">
          <div class="col-md-6">
            <h4 class="text-center mb-3">Bride</h4>
            <div class="form-group mb-3">
              <label for="brideFirstName">First Name</label>
              <input type="text" id="brideFirstName" class="form-control" [(ngModel)]="coupleDetails.brideFirstName">
            </div>
            <div class="form-group mb-3">
              <label for="brideLastName">Last Name</label>
              <input type="text" id="brideLastName" class="form-control" [(ngModel)]="coupleDetails.brideLastName">
            </div>
            <div class="form-group mb-3">
              <label for="brideAge">Age</label>
              <input type="number" id="brideAge" class="form-control" [(ngModel)]="coupleDetails.brideAge">
            </div>
          </div>
          <div class="col-md-6">
            <h4 class="text-center mb-3">Groom</h4>
            <div class="form-group mb-3">
              <label for="groomFirstName">First Name</label>
              <input type="text" id="groomFirstName" class="form-control" [(ngModel)]="coupleDetails.groomFirstName">
            </div>
            <div class="form-group mb-3">
              <label for="groomLastName">Last Name</label>
              <input type="text" id="groomLastName" class="form-control" [(ngModel)]="coupleDetails.groomLastName">
            </div>
            <div class="form-group mb-3">
              <label for="groomAge">Age</label>
              <input type="number" id="groomAge" class="form-control" [(ngModel)]="coupleDetails.groomAge">
            </div>
          </div>
        </div>
      </div>
      
      <!-- Couple Photo Display - shown after save -->
      <div *ngIf="showCouplePhoto" class="couple-photo-display">
        <div class="couple-names">{{ coupleDetails.brideFirstName }} & {{ coupleDetails.groomFirstName }}</div>
        <div class="photo-container">
          <img src="assets/couple-details.png" alt="Couple" class="couple-photo">
        </div>
        <div class="edit-button-container">
          <button class="btn btn-outline-primary btn-sm" (click)="editCoupleDetails()">
            <i class="fas fa-edit"></i> Edit Details
          </button>
        </div>
      </div>
    </div>

    <!-- Event Information Section -->
    <div class="section-card">
      <div class="section-header">
        <h2><i class="fas fa-calendar-alt"></i> Event Information</h2>
      </div>
      <div class="row">
        <div class="col-md-6">
          <label for="eventDate">Wedding Date</label>
          <div class="date-input-container">
            <div *ngIf="!eventInformation.date" class="date-input">
              <input type="date" id="eventDate" class="form-control" [(ngModel)]="eventInformation.date" (change)="onDateChange()" (blur)="onDateChange()">
            </div>
            <div *ngIf="eventInformation.date" class="selected-date">
              {{ eventInformation.date | date:'longDate' }}
              <button class="btn btn-outline-primary btn-sm edit-btn" (click)="editEventDate()">
                <i class="fas fa-edit"></i> Edit
              </button>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <label for="eventLocation">Location</label>
          <div class="location-input-container">
            <div *ngIf="!eventInformation.location" class="location-input">
              <input type="text" id="eventLocation" class="form-control" [(ngModel)]="eventInformation.location" placeholder="City, State" (keyup.enter)="saveLocation()" (blur)="saveLocation()">
            </div>
            <div *ngIf="eventInformation.location" class="selected-location">
              {{ eventInformation.location }}
              <button class="btn btn-outline-primary btn-sm edit-btn" (click)="editLocation()">
                <i class="fas fa-edit"></i> Edit
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Guests Section -->
    <div class="section-card">
      <div class="section-header">
        <h2><i class="fas fa-users"></i> Guests</h2>
        <a routerLink="/guest-list" class="btn btn-outline-primary btn-sm">Manage Guests</a>
      </div>
      <div class="row text-center">
        <div class="col-md-6">
          <div class="guest-count-card bride-guests">
            <h3>{{ guestSummary.brideGuests }}</h3>
            <p>Bride's Guests</p>
          </div>
        </div>
        <div class="col-md-6">
          <div class="guest-count-card groom-guests">
            <h3>{{ guestSummary.groomGuests }}</h3>
            <p>Groom's Guests</p>
          </div>
        </div>
      </div>
      <div class="row mt-3">
        <div class="col-md-6">
          <div class="guest-summary-item">
            <span class="label">Wedding Party:</span>
            <span class="value">{{ guestSummary.totalGuests }} total guests</span>
          </div>
        </div>
        <div class="col-md-6">
          <div class="guest-summary-item">
            <span class="label">Confirmed RSVPs:</span>
            <span class="value">{{ guestSummary.confirmedRSVPs }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Checklist Section -->
    <div class="section-card">
      <div class="section-header">
        <h2><i class="fas fa-tasks"></i> Checklist</h2>
        <a routerLink="/tasks" class="btn btn-outline-primary btn-sm">Manage Tasks</a>
      </div>
      <div class="progress-section">
        <div class="progress-info">
          <span>{{ checklistProgress.completedTasks }} of {{ checklistProgress.totalTasks }} tasks completed</span>
          <span class="progress-percentage">{{ checklistProgress.progressPercentage }}%</span>
        </div>
        <div class="progress">
          <div class="progress-bar" role="progressbar" 
               [style.width.%]="checklistProgress.progressPercentage" 
               [attr.aria-valuenow]="checklistProgress.progressPercentage" 
               aria-valuemin="0" aria-valuemax="100">
          </div>
        </div>
      </div>
    </div>

    <!-- Budget Section -->
    <div class="section-card">
      <div class="section-header">
        <h2><i class="fas fa-dollar-sign"></i> Budget</h2>
        <a routerLink="/budget-tracker" class="btn btn-outline-primary btn-sm">Manage Budget</a>
      </div>
      <div class="budget-overview">
        <div class="row text-center">
          <div class="col-md-4">
            <div class="budget-item">
              <h4>${{ budgetOverview.totalBudget.toLocaleString() }}</h4>
              <p>Total Budget</p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="budget-item spent">
              <h4>${{ budgetOverview.spentAmount.toLocaleString() }}</h4>
              <p>Spent</p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="budget-item remaining">
              <h4>${{ budgetOverview.remainingAmount.toLocaleString() }}</h4>
              <p>Remaining</p>
            </div>
          </div>
        </div>
        <div class="budget-progress mt-3">
          <div class="progress">
            <div class="progress-bar bg-success" role="progressbar" 
                 [style.width.%]="budgetOverview.progressPercentage" 
                 [attr.aria-valuenow]="budgetOverview.progressPercentage" 
                 aria-valuemin="0" aria-valuemax="100">
            </div>
          </div>
          <small class="text-muted">Budget utilization: {{ budgetOverview.progressPercentage }}%</small>
        </div>
      </div>
    </div>

    <!-- Event Itinerary Section -->
    <div class="section-card">
      <div class="section-header">
        <h2><i class="fas fa-clock"></i> Event Itinerary</h2>
      </div>
      
      <div class="itinerary-timeline-container">
        <div class="itinerary-timeline">
          <div class="timeline-item" *ngFor="let item of eventItinerary; let i = index">
            <div class="timeline-time">
              <span *ngIf="!item.isEditing">{{ item.time }}</span>
              <div *ngIf="item.isEditing" class="time-picker">
                <select class="form-control form-control-sm" 
                        [value]="getHourFromTime(item.time)" 
                        (change)="updateTimeHour(i, $event)">
                  <option *ngFor="let hour of getHours()" [value]="hour">{{ hour.toString().padStart(2, '0') }}</option>
                </select>
                <span class="time-separator">:</span>
                <select class="form-control form-control-sm" 
                        [value]="getMinuteFromTime(item.time)" 
                        (change)="updateTimeMinute(i, $event)">
                  <option *ngFor="let minute of getMinutes()" [value]="minute">{{ minute.toString().padStart(2, '0') }}</option>
                </select>
              </div>
            </div>
            <div class="timeline-content">
              <h5 *ngIf="!item.isEditing">{{ item.event }}</h5>
              <input *ngIf="item.isEditing" type="text" class="form-control form-control-sm mb-1" 
                     [value]="item.event" (input)="updateItineraryItem(i, 'event', $event)">
              <p *ngIf="!item.isEditing">{{ item.description }}</p>
              <input *ngIf="item.isEditing" type="text" class="form-control form-control-sm" 
                     [value]="item.description" (input)="updateItineraryItem(i, 'description', $event)">
            </div>
            <div class="timeline-actions">
              <mat-icon *ngIf="!item.isEditing" class="edit-icon" 
                       (click)="startEditItem(i)" 
                       title="Edit Item">edit</mat-icon>
              <mat-icon *ngIf="!item.isEditing" class="delete-icon" 
                       (click)="removeItineraryItem(i)" 
                       title="Delete Item">delete</mat-icon>
              <div *ngIf="item.isEditing" class="edit-actions">
                <mat-icon class="save-icon" 
                         (click)="saveItem(i)" 
                         title="Save Changes">check</mat-icon>
                <mat-icon class="delete-icon" 
                         (click)="cancelEditItem(i)" 
                         title="Cancel Edit">close</mat-icon>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Add New Item Form -->
      <div class="add-item-form mt-3">
        <h6>Add New Item</h6>
        <div class="form-row">
          <div class="col-md-3">
            <div class="time-picker">
              <select class="form-control form-control-sm" 
                      [(ngModel)]="newItineraryItem.hour" 
                      name="newHour">
                <option *ngFor="let hour of getHours()" [value]="hour">{{ hour.toString().padStart(2, '0') }}</option>
              </select>
              <span class="time-separator">:</span>
              <select class="form-control form-control-sm" 
                      [(ngModel)]="newItineraryItem.minute" 
                      name="newMinute">
                <option *ngFor="let minute of getMinutes()" [value]="minute">{{ minute.toString().padStart(2, '0') }}</option>
              </select>
            </div>
          </div>
          <div class="col-md-4">
            <input type="text" class="form-control form-control-sm" 
                   [(ngModel)]="newItineraryItem.event" placeholder="Event">
          </div>
          <div class="col-md-4">
            <input type="text" class="form-control form-control-sm" 
                   [(ngModel)]="newItineraryItem.description" placeholder="Description">
          </div>
          <div class="col-md-1">
            <mat-icon class="add-icon" (click)="addItineraryItem()" title="Add New Item">add</mat-icon>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
